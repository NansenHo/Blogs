# 传统编译型语言的编译过程

传统编译语言在源代码被执行前，会经历 ”编译“ 三阶段：

[toc]

## 1. 分词/词法分析（Tokenizing/Lexing）

该阶段**将字符串分解成对编程语言来说有意义的代码块**，这些代码块叫做**词法单元（token）**。

程序 `var a = 2;` 会被分解成以下词法单元：`var` `a` `=` `2` `;` 。

> 分词（tokenizing）和词法分析（Lexing）之间的区别是非常微妙、晦涩的，
> 
> 主要差异在于词法单元的识别是通过有状态还是无状态的方式进行的。
> 
> 简单来说，如果词法单元生成器在判断 a 是一个独立的词法单元还是其他词法单元的一部分时，调用的是有状态的解析规则，那么这个过程就被称为词法分析。

> 空格是否算作词法单元，取决于空格在这门语言中是否具有意义。

## 2. 解析/语法分析（Parsing）

该阶段将词法单元流（数组）转换成一个由元素逐级嵌套所组成的代表了程序语法结构的树。

这棵树叫做**抽象语法树 AST**（Abstract Syntax Tree）。

比如，`var a = 2;` 的的抽象树就如下图所示：

```

                 VariableDeclaration 顶级节点
                            |
                            v
          +-----------------+-----------------+
          |                                   |
          v                                   v
  Identifier 节点（值为 a）         AssignmentExpression 节点
                                              |
                                              v
                                  NumericLiteral 节点（值为 2）

Variable: 多变的adj，变量n
Declaration: 声明n
Identifier: 识别符号,识别码n
Assignment: 任务n 分配,指派n
Expression: 词,词语,措辞n
NumericLiteral: 数字字面量n
Literal: 字面量n
```

## 3. 代码生成

该阶段**将 AST 转换为可执行代码**（代码生成）。

这一阶段与语言、目标平台等息息相关。