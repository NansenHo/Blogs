# 多表查询

`SELECT` 查询不但可以从一张表查询数据，还可以从多张表同时查询数据。

查询多张表的语法是：`SELECT * FROM <表1> <表2>`。

> 一般使用主键或外键进行多表关联查询。

一次查询两个表的数据，查询的结果也是一个二维表。

比如，我们查询

```sql
SELECT * FROM students, classes;
```

会返回 `students` 表和 `classes` 表的 **“乘积”**，即 `students` 表的每一行与 `classes` 表的每一行都两两拼在一起返回。

| id  | class_id | name | gender | score | id  | name |
| :-- | :------- | :--- | :----- | :---- | :-- | :--- |
| 1   | 1        | 小明 | M      | 90    | 1   | 一班 |
| 1   | 1        | 小明 | M      | 90    | 2   | 二班 |
| 1   | 1        | 小明 | M      | 90    | 3   | 三班 |
| 1   | 1        | 小明 | M      | 90    | 4   | 四班 |
| 2   | 1        | 小红 | F      | 95    | 1   | 一班 |
| 2   | 1        | 小红 | F      | 95    | 2   | 二班 |
| ... | ...      | ...  | ...    | ...   | ... | ...  |

这种多表查询又称笛卡尔查询。

> **使用笛卡尔查询时要非常小心**
>
> 由于结果集是目标表的行数乘积，
>
> - 对两个各自有 `100` 行记录的表进行笛卡尔查询将返回 `1` 万条记录，
> - 对两个各自有 `1` 万行记录的表进行笛卡尔查询将返回 `1` 亿条记录。
>
> 多表查询的结果集可能非常巨大，要小心使用。

> 笛卡尔乘积没太多意义，而且很容易查询量爆炸，不建议使用。

上述查询的结果集有两列 `id` 和两列 `name`。

两列 `id` 是因为其中一列是 `students` 表的 `id`，而另一列是 `classes` 表的 `id`，但是在结果集中，不好区分。两列 `name` 同理。

要解决这个问题，我们通常给列设置别名。

```sql
SELECT
    students.id sid,
    students.name sname,
    students.gender,
    students.score,
    classes.id cid,
    classes.name cname
FROM students, classes;
```

> 注意：
>
> 多表查询时，要使用 `表名.列名` 这样的方式来引用列和设置别名，这样就避免了结果集的列名重复问题。

但用 `表名.列名` 这种方式列举两个表的所有列实在是很麻烦。

所以 SQL 还允许给表设置一个别名，让我们在投影查询中引用起来稍微简洁一点：

```sql
SELECT
    s.id sid,
    s.name sname,
    s.gender,
    s.score,
    c.id cid,
    c.name cname
FROM students s, classes c;
```

`FROM` 子句给表设置别名的语法是 `FROM <表名1> <别名1>, <表名2> <别名2>`。
