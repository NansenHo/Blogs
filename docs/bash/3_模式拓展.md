# Bash 的模式扩展

Shell 接收到用户输入的命令以后，会**根据空格**将用户的输入，拆分成一个个词元（token）。

然后，Shell 会扩展词元里面的特殊字符，扩展完成后才会调用相应的命令。

这种特殊字符的扩展，称为模式扩展（globbing）。

其中有些用到通配符，又称为通配符扩展（wildcard expansion）。

Bash 一共提供八种扩展：

- 波浪线扩展
- `?` 字符扩展
- `*` 字符扩展
- 方括号扩展
- 大括号扩展
- 变量扩展
- 子命令扩展
- 算术扩展

模块扩展的英文单词是 globbing，这个词来自于早期的 Unix 系统有一个 `/etc/glob` 文件，保存扩展的模板。

后来 Bash 内置了这个功能，但是这个名字就保留了下来。

> 模式扩展与正则表达式的关系是，模式扩展早于正则表达式出现，可以看作是原始的正则表达式。
>
> 它的功能没有正则那么强大灵活，但是优点是简单和方便。

Bash 允许用户关闭扩展。

```bash
set -o noglob
# 或者
set -f
```

下面的命令可以重新打开扩展。

```bash
set +o noglob
# 或者
set +f
```

## 波浪线拓展

波浪线 `~` 会自动拓展成当前用户的主目录。

```bash
echo ~
/Users/nansenho
```

`~/dirName` 会拓展成主目录的 `dirName` 子目录。

## `?` 字符拓展

`?` 字符代表文件路径里面的任意单个字符，不包括空字符。

比如，`Data???` 匹配所有 `Data` 后面跟着三个字符的文件名。

```bash
ls ?????.js
hello.js
```

## `*` 字符拓展

`*` 字符代表文件路径里面的**任意数量的任意字符，包括零个字符**。

```bash
# 存在文件 a.txt、b.txt 和 ab.txt
ls *.txt
a.txt b.txt ab.txt
```

注意，`*` 不会匹配隐藏文件（以 `.` 开头的文件），即 `ls *` 不会输出隐藏文件。

如果要匹配隐藏文件，需要写成 `.*`。

Bash 4.0 引入了一个参数 globstar，当该参数打开时，允许 `**` 匹配零个或多个子目录。

因此，`**/*.txt` 可以匹配顶层的文本文件和任意深度子目录的文本文件。

## 方括号拓展

方括号扩展的形式是 `[...]`，只有文件确实存在的前提下才会扩展。

如果文件不存在，就会原样输出。

括号之中的任意一个字符。比如，[aeiou] 可以匹配五个元音字母中的任意一个。
